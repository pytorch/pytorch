# Basic benchmark configuration for PyTorch transformer benchmarks
# Usage: python score_mod.py --config config_basic.yaml

# Core parameters
dynamic: false
calculate_bwd: false
dtype: "bfloat16"

# Shape parameters
b: [2, 4]  # batch sizes
nh: ["16,16", "16,4"]  # [query_heads,key_value_heads]
s: [1024, 2048, 4096, 8192]  # sequence lengths
d: [64, 128]  # head dimensions

# Attention types to benchmark
mods: ["noop", "causal", "alibi", "sliding_window"]

# Backend and optimization
backend: ["efficient", "math"]  # SDPA backends
max_autotune: true  # Enable torch.compile with max-autotune for optimal performance

# Decoding and cache settings
decoding: false
kv_size: null  # Use batch sizes instead

# Metrics and output
throughput: true  # Calculate memory bandwidth & TFLOPS
save_path: "basic_results.csv"  # Save to CSV
output_json_for_dashboard: "basic_dashboard.json"  # Save JSON for PyTorch OSS dashboard
