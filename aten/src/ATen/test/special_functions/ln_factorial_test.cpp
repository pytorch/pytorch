#include <gtest/gtest.h>
#include <ATen/native/special_functions/ln_factorial.h>

template<typename T1>
struct ln_factorial_fixture {
  T1 f0;
  unsigned int n;
  T1 f;
};

const ln_factorial_fixture<double> fixture_0001[501] = {
    {0.0000000000000000, 0, 0.0},
    {0.0000000000000000, 1, 0.0},
    {0.69314718055994529, 2, 0.0},
    {1.7917594692280550, 3, 0.0},
    {3.1780538303479458, 4, 0.0},
    {4.7874917427820458, 5, 0.0},
    {6.5792512120101012, 6, 0.0},
    {8.5251613610654147, 7, 0.0},
    {10.604602902745251, 8, 0.0},
    {12.801827480081469, 9, 0.0},
    {15.104412573075516, 10, 0.0},
    {17.502307845873887, 11, 0.0},
    {19.987214495661885, 12, 0.0},
    {22.552163853123425, 13, 0.0},
    {25.191221182738680, 14, 0.0},
    {27.899271383840890, 15, 0.0},
    {30.671860106080672, 16, 0.0},
    {33.505073450136891, 17, 0.0},
    {36.395445208033053, 18, 0.0},
    {39.339884187199495, 19, 0.0},
    {42.335616460753485, 20, 0.0},
    {45.380138898476908, 21, 0.0},
    {48.471181351835227, 22, 0.0},
    {51.606675567764377, 23, 0.0},
    {54.784729398112319, 24, 0.0},
    {58.003605222980518, 25, 0.0},
    {61.261701761002001, 26, 0.0},
    {64.557538627006338, 27, 0.0},
    {67.889743137181540, 28, 0.0},
    {71.257038967168015, 29, 0.0},
    {74.658236348830158, 30, 0.0},
    {78.092223553315307, 31, 0.0},
    {81.557959456115043, 32, 0.0},
    {85.054467017581516, 33, 0.0},
    {88.580827542197682, 34, 0.0},
    {92.136175603687093, 35, 0.0},
    {95.719694542143202, 36, 0.0},
    {99.330612454787428, 37, 0.0},
    {102.96819861451381, 38, 0.0},
    {106.63176026064346, 39, 0.0},
    {110.32063971475739, 40, 0.0},
    {114.03421178146171, 41, 0.0},
    {117.77188139974507, 42, 0.0},
    {121.53308151543864, 43, 0.0},
    {125.31727114935690, 44, 0.0},
    {129.12393363912722, 45, 0.0},
    {132.95257503561632, 46, 0.0},
    {136.80272263732635, 47, 0.0},
    {140.67392364823425, 48, 0.0},
    {144.56574394634490, 49, 0.0},
    {148.47776695177302, 50, 0.0},
    {152.40959258449735, 51, 0.0},
    {156.36083630307880, 52, 0.0},
    {160.33112821663090, 53, 0.0},
    {164.32011226319517, 54, 0.0},
    {168.32744544842765, 55, 0.0},
    {172.35279713916279, 56, 0.0},
    {176.39584840699735, 57, 0.0},
    {180.45629141754378, 58, 0.0},
    {184.53382886144948, 59, 0.0},
    {188.62817342367160, 60, 0.0},
    {192.73904728784490, 61, 0.0},
    {196.86618167289001, 62, 0.0},
    {201.00931639928152, 63, 0.0},
    {205.16819948264120, 64, 0.0},
    {209.34258675253685, 65, 0.0},
    {213.53224149456327, 66, 0.0},
    {217.73693411395422, 67, 0.0},
    {221.95644181913033, 68, 0.0},
    {226.19054832372760, 69, 0.0},
    {230.43904356577696, 70, 0.0},
    {234.70172344281826, 71, 0.0},
    {238.97838956183432, 72, 0.0},
    {243.26884900298271, 73, 0.0},
    {247.57291409618688, 74, 0.0},
    {251.89040220972319, 75, 0.0},
    {256.22113555000954, 76, 0.0},
    {260.56494097186322, 77, 0.0},
    {264.92164979855278, 78, 0.0},
    {269.29109765101981, 79, 0.0},
    {273.67312428569369, 80, 0.0},
    {278.06757344036612, 81, 0.0},
    {282.47429268763040, 82, 0.0},
    {286.89313329542699, 83, 0.0},
    {291.32395009427029, 84, 0.0},
    {295.76660135076065, 85, 0.0},
    {300.22094864701415, 86, 0.0},
    {304.68685676566872, 87, 0.0},
    {309.16419358014690, 88, 0.0},
    {313.65282994987905, 89, 0.0},
    {318.15263962020930, 90, 0.0},
    {322.66349912672615, 91, 0.0},
    {327.18528770377520, 92, 0.0},
    {331.71788719692847, 93, 0.0},
    {336.26118197919845, 94, 0.0},
    {340.81505887079902, 95, 0.0},
    {345.37940706226686, 96, 0.0},
    {349.95411804077025, 97, 0.0},
    {354.53908551944079, 98, 0.0},
    {359.13420536957540, 99, 0.0},
    {363.73937555556347, 100, 0.0},
    {368.35449607240474, 101, 0.0},
    {372.97946888568902, 102, 0.0},
    {377.61419787391867, 103, 0.0},
    {382.25858877306001, 104, 0.0},
    {386.91254912321756, 105, 0.0},
    {391.57598821732961, 106, 0.0},
    {396.24881705179155, 107, 0.0},
    {400.93094827891576, 108, 0.0},
    {405.62229616114490, 109, 0.0},
    {410.32277652693733, 110, 0.0},
    {415.03230672824964, 111, 0.0},
    {419.75080559954472, 112, 0.0},
    {424.47819341825709, 113, 0.0},
    {429.21439186665157, 114, 0.0},
    {433.95932399501481, 115, 0.0},
    {438.71291418612117, 116, 0.0},
    {443.47508812091894, 117, 0.0},
    {448.24577274538461, 118, 0.0},
    {453.02489623849613, 119, 0.0},
    {457.81238798127816, 120, 0.0},
    {462.60817852687489, 121, 0.0},
    {467.41219957160820, 122, 0.0},
    {472.22438392698058, 123, 0.0},
    {477.04466549258564, 124, 0.0},
    {481.87297922988796, 125, 0.0},
    {486.70926113683942, 126, 0.0},
    {491.55344822329801, 127, 0.0},
    {496.40547848721764, 128, 0.0},
    {501.26529089157930, 129, 0.0},
    {506.13282534203489, 130, 0.0},
    {511.00802266523601, 131, 0.0},
    {515.89082458782241, 132, 0.0},
    {520.78117371604412, 133, 0.0},
    {525.67901351599505, 134, 0.0},
    {530.58428829443346, 135, 0.0},
    {535.49694318016952, 136, 0.0},
    {540.41692410599762, 137, 0.0},
    {545.34417779115483, 138, 0.0},
    {550.27865172428551, 139, 0.0},
    {555.22029414689484, 140, 0.0},
    {560.16905403727299, 141, 0.0},
    {565.12488109487435, 142, 0.0},
    {570.08772572513419, 143, 0.0},
    {575.05753902471020, 144, 0.0},
    {580.03427276713080, 145, 0.0},
    {585.01787938883911, 146, 0.0},
    {590.00831197561786, 147, 0.0},
    {595.00552424938201, 148, 0.0},
    {600.00947055532743, 149, 0.0},
    {605.02010584942366, 150, 0.0},
    {610.03738568623862, 151, 0.0},
    {615.06126620708494, 152, 0.0},
    {620.09170412847732, 153, 0.0},
    {625.12865673089095, 154, 0.0},
    {630.17208184781020, 155, 0.0},
    {635.22193785505976, 156, 0.0},
    {640.27818366040799, 157, 0.0},
    {645.34077869343503, 158, 0.0},
    {650.40968289565524, 159, 0.0},
    {655.48485671088906, 160, 0.0},
    {660.56626107587351, 161, 0.0},
    {665.65385741110595, 162, 0.0},
    {670.74760761191271, 163, 0.0},
    {675.84747403973688, 164, 0.0},
    {680.95341951363741, 165, 0.0},
    {686.06540730199401, 166, 0.0},
    {691.18340111441080, 167, 0.0},
    {696.30736509381404, 168, 0.0},
    {701.43726380873704, 169, 0.0},
    {706.57306224578736, 170, 0.0},
    {711.71472580228999, 171, 0.0},
    {716.86222027910344, 172, 0.0},
    {722.01551187360121, 173, 0.0},
    {727.17456717281561, 174, 0.0},
    {732.33935314673920, 175, 0.0},
    {737.50983714177744, 176, 0.0},
    {742.68598687435122, 177, 0.0},
    {747.86777042464314, 178, 0.0},
    {753.05515623048404, 179, 0.0},
    {758.24811308137419, 180, 0.0},
    {763.44661011263997, 181, 0.0},
    {768.65061679971689, 182, 0.0},
    {773.86010295255824, 183, 0.0},
    {779.07503871016718, 184, 0.0},
    {784.29539453524569, 185, 0.0},
    {789.52114120895885, 186, 0.0},
    {794.75224982581335, 187, 0.0},
    {799.98869178864322, 188, 0.0},
    {805.23043880370290, 189, 0.0},
    {810.47746287586335, 190, 0.0},
    {815.72973630391004, 191, 0.0},
    {820.98723167593789, 192, 0.0},
    {826.24992186484269, 193, 0.0},
    {831.51778002390608, 194, 0.0},
    {836.79077958246990, 195, 0.0},
    {842.06889424170038, 196, 0.0},
    {847.35209797043831, 197, 0.0},
    {852.64036500113298, 198, 0.0},
    {857.93366982585746, 199, 0.0},
    {863.23198719240543, 200, 0.0},
    {868.53529210046452, 201, 0.0},
    {873.84355979786551, 202, 0.0},
    {879.15676577690749, 203, 0.0},
    {884.47488577075171, 204, 0.0},
    {889.79789574989013, 205, 0.0},
    {895.12577191867967, 206, 0.0},
    {900.45849071194505, 207, 0.0},
    {905.79602879164645, 208, 0.0},
    {911.13836304361109, 209, 0.0},
    {916.48547057432859, 210, 0.0},
    {921.83732870780455, 211, 0.0},
    {927.19391498247660, 212, 0.0},
    {932.55520714818613, 213, 0.0},
    {937.92118316320796, 214, 0.0},
    {943.29182119133554, 215, 0.0},
    {948.66709959901982, 216, 0.0},
    {954.04699695256022, 217, 0.0},
    {959.43149201534936, 218, 0.0},
    {964.82056374516583, 219, 0.0},
    {970.21419129151809, 220, 0.0},
    {975.61235399303598, 221, 0.0},
    {981.01503137490829, 222, 0.0},
    {986.42220314636825, 223, 0.0},
    {991.83384919822333, 224, 0.0},
    {997.24994960042795, 225, 0.0},
    {1002.6704845997001, 226, 0.0},
    {1008.0954346171814, 227, 0.0},
    {1013.5247802461359, 228, 0.0},
    {1018.9585022496900, 229, 0.0},
    {1024.3965815586134, 230, 0.0},
    {1029.8389992691352, 231, 0.0},
    {1035.2857366408016, 232, 0.0},
    {1040.7367750943670, 233, 0.0},
    {1046.1920962097249, 234, 0.0},
    {1051.6516817238689, 235, 0.0},
    {1057.1155135288946, 236, 0.0},
    {1062.5835736700296, 237, 0.0},
    {1068.0558443437010, 238, 0.0},
    {1073.5323078956328, 239, 0.0},
    {1079.0129468189748, 240, 0.0},
    {1084.4977437524653, 241, 0.0},
    {1089.9866814786221, 242, 0.0},
    {1095.4797429219625, 243, 0.0},
    {1100.9769111472558, 244, 0.0},
    {1106.4781693578007, 245, 0.0},
    {1111.9835008937330, 246, 0.0},
    {1117.4928892303608, 247, 0.0},
    {1123.0063179765259, 248, 0.0},
    {1128.5237708729906, 249, 0.0},
    {1134.0452317908528, 250, 0.0},
    {1139.5706847299846, 251, 0.0},
    {1145.1001138174961, 252, 0.0},
    {1150.6335033062235, 253, 0.0},
    {1156.1708375732421, 254, 0.0},
    {1161.7121011184006, 255, 0.0},
    {1167.2572785628802, 256, 0.0},
    {1172.8063546477754, 257, 0.0},
    {1178.3593142326968, 258, 0.0},
    {1183.9161422943966, 259, 0.0},
    {1189.4768239254117, 260, 0.0},
    {1195.0413443327348, 261, 0.0},
    {1200.6096888364957, 262, 0.0},
    {1206.1818428686736, 263, 0.0},
    {1211.7577919718199, 264, 0.0},
    {1217.3375217978059, 265, 0.0},
    {1222.9210181065878, 266, 0.0},
    {1228.5082667649881, 267, 0.0},
    {1234.0992537454990, 268, 0.0},
    {1239.6939651251007, 269, 0.0},
    {1245.2923870840991, 270, 0.0},
    {1250.8945059049788, 271, 0.0},
    {1256.5003079712749, 272, 0.0},
    {1262.1097797664600, 273, 0.0},
    {1267.7229078728478, 274, 0.0},
    {1273.3396789705146, 275, 0.0},
    {1278.9600798362317, 276, 0.0},
    {1284.5840973424188, 277, 0.0},
    {1290.2117184561096, 278, 0.0},
    {1295.8429302379311, 279, 0.0},
    {1301.4777198411002, 280, 0.0},
    {1307.1160745104339, 281, 0.0},
    {1312.7579815813720, 282, 0.0},
    {1318.4034284790155, 283, 0.0},
    {1324.0524027171764, 284, 0.0},
    {1329.7048918974451, 285, 0.0},
    {1335.3608837082650, 286, 0.0},
    {1341.0203659240246, 287, 0.0},
    {1346.6833264041604, 288, 0.0},
    {1352.3497530922732, 289, 0.0},
    {1358.0196340152536, 290, 0.0},
    {1363.6929572824249, 291, 0.0},
    {1369.3697110846933, 292, 0.0},
    {1375.0498836937104, 293, 0.0},
    {1380.7334634610490, 294, 0.0},
    {1386.4204388173889, 295, 0.0},
    {1392.1107982717131, 296, 0.0},
    {1397.8045304105156, 297, 0.0},
    {1403.5016238970211, 298, 0.0},
    {1409.2020674704117, 299, 0.0},
    {1414.9058499450680, 300, 0.0},
    {1420.6129602098169, 301, 0.0},
    {1426.3233872271917, 302, 0.0},
    {1432.0371200327011, 303, 0.0},
    {1437.7541477341072, 304, 0.0},
    {1443.4744595107147, 305, 0.0},
    {1449.1980446126670, 306, 0.0},
    {1454.9248923602543, 307, 0.0},
    {1460.6549921432279, 308, 0.0},
    {1466.3883334201255, 309, 0.0},
    {1472.1249057176046, 310, 0.0},
    {1477.8646986297840, 311, 0.0},
    {1483.6077018175934, 312, 0.0},
    {1489.3539050081336, 313, 0.0},
    {1495.1032979940417, 314, 0.0},
    {1500.8558706328674, 315, 0.0},
    {1506.6116128464546, 316, 0.0},
    {1512.3705146203317, 317, 0.0},
    {1518.1325660031118, 318, 0.0},
    {1523.8977571058965, 319, 0.0},
    {1529.6660781016901, 320, 0.0},
    {1535.4375192248206, 321, 0.0},
    {1541.2120707703648, 322, 0.0},
    {1546.9897230935876, 323, 0.0},
    {1552.7704666093798, 324, 0.0},
    {1558.5542917917096, 325, 0.0},
    {1564.3411891730764, 326, 0.0},
    {1570.1311493439737, 327, 0.0},
    {1575.9241629523576, 328, 0.0},
    {1581.7202207031230, 329, 0.0},
    {1587.5193133575835, 330, 0.0},
    {1593.3214317329605, 331, 0.0},
    {1599.1265667018770, 332, 0.0},
    {1604.9347091918576, 333, 0.0},
    {1610.7458501848344, 334, 0.0},
    {1616.5599807166593, 335, 0.0},
    {1622.3770918766224, 336, 0.0},
    {1628.1971748069750, 337, 0.0},
    {1634.0202207024579, 338, 0.0},
    {1639.8462208098383, 339, 0.0},
    {1645.6751664274484, 340, 0.0},
    {1651.5070489047321, 341, 0.0},
    {1657.3418596417948, 342, 0.0},
    {1663.1795900889606, 343, 0.0},
    {1669.0202317463340, 344, 0.0},
    {1674.8637761633654, 345, 0.0},
    {1680.7102149384232, 346, 0.0},
    {1686.5595397183699, 347, 0.0},
    {1692.4117421981443, 348, 0.0},
    {1698.2668141203469, 349, 0.0},
    {1704.1247472748303, 350, 0.0},
    {1709.9855334982960, 351, 0.0},
    {1715.8491646738944, 352, 0.0},
    {1721.7156327308276, 353, 0.0},
    {1727.5849296439615, 354, 0.0},
    {1733.4570474334369, 355, 0.0},
    {1739.3319781642888, 356, 0.0},
    {1745.2097139460684, 357, 0.0},
    {1751.0902469324692, 358, 0.0},
    {1756.9735693209575, 359, 0.0},
    {1762.8596733524075, 360, 0.0},
    {1768.7485513107404, 361, 0.0},
    {1774.6401955225665, 362, 0.0},
    {1780.5345983568311, 363, 0.0},
    {1786.4317522244678, 364, 0.0},
    {1792.3316495780502, 365, 0.0},
    {1798.2342829114518, 366, 0.0},
    {1804.1396447595062, 367, 0.0},
    {1810.0477276976751, 368, 0.0},
    {1815.9585243417157, 369, 0.0},
    {1821.8720273473541, 370, 0.0},
    {1827.7882294099613, 371, 0.0},
    {1833.7071232642345, 372, 0.0},
    {1839.6287016838785, 373, 0.0},
    {1845.5529574812929, 374, 0.0},
    {1851.4798835072631, 375, 0.0},
    {1857.4094726506532, 376, 0.0},
    {1863.3417178381014, 377, 0.0},
    {1869.2766120337210, 378, 0.0},
    {1875.2141482388033, 379, 0.0},
    {1881.1543194915239, 380, 0.0},
    {1887.0971188666504, 381, 0.0},
    {1893.0425394752569, 382, 0.0},
    {1898.9905744644377, 383, 0.0},
    {1904.9412170170253, 384, 0.0},
    {1910.8944603513130, 385, 0.0},
    {1916.8502977207779, 386, 0.0},
    {1922.8087224138080, 387, 0.0},
    {1928.7697277534312, 388, 0.0},
    {1934.7333070970494, 389, 0.0},
    {1940.6994538361732, 390, 0.0},
    {1946.6681613961587, 391, 0.0},
    {1952.6394232359489, 392, 0.0},
    {1958.6132328478184, 393, 0.0},
    {1964.5895837571161, 394, 0.0},
    {1970.5684695220175, 395, 0.0},
    {1976.5498837332718, 396, 0.0},
    {1982.5338200139593, 397, 0.0},
    {1988.5202720192433, 398, 0.0},
    {1994.5092334361334, 399, 0.0},
    {2000.5006979832413, 400, 0.0},
    {2006.4946594105479, 401, 0.0},
    {2012.4911114991669, 402, 0.0},
    {2018.4900480611138, 403, 0.0},
    {2024.4914629390746, 404, 0.0},
    {2030.4953500061811, 405, 0.0},
    {2036.5017031657828, 406, 0.0},
    {2042.5105163512255, 407, 0.0},
    {2048.5217835256299, 408, 0.0},
    {2054.5354986816728, 409, 0.0},
    {2060.5516558413710, 410, 0.0},
    {2066.5702490558670, 411, 0.0},
    {2072.5912724052168, 412, 0.0},
    {2078.6147199981774, 413, 0.0},
    {2084.6405859720026, 414, 0.0},
    {2090.6688644922338, 415, 0.0},
    {2096.6995497524949, 416, 0.0},
    {2102.7326359742942, 417, 0.0},
    {2108.7681174068189, 418, 0.0},
    {2114.8059883267406, 419, 0.0},
    {2120.8462430380182, 420, 0.0},
    {2126.8888758717003, 421, 0.0},
    {2132.9338811857369, 422, 0.0},
    {2138.9812533647823, 423, 0.0},
    {2145.0309868200143, 424, 0.0},
    {2151.0830759889391, 425, 0.0},
    {2157.1375153352083, 426, 0.0},
    {2163.1942993484372, 427, 0.0},
    {2169.2534225440190, 428, 0.0},
    {2175.3148794629469, 429, 0.0},
    {2181.3786646716344, 430, 0.0},
    {2187.4447727617380, 431, 0.0},
    {2193.5131983499823, 432, 0.0},
    {2199.5839360779851, 433, 0.0},
    {2205.6569806120856, 434, 0.0},
    {2211.7323266431736, 435, 0.0},
    {2217.8099688865227, 436, 0.0},
    {2223.8899020816184, 437, 0.0},
    {2229.9721209919949, 438, 0.0},
    {2236.0566204050701, 439, 0.0},
    {2242.1433951319827, 440, 0.0},
    {2248.2324400074294, 441, 0.0},
    {2254.3237498895073, 442, 0.0},
    {2260.4173196595520, 443, 0.0},
    {2266.5131442219845, 444, 0.0},
    {2272.6112185041511, 445, 0.0},
    {2278.7115374561708, 446, 0.0},
    {2284.8140960507844, 447, 0.0},
    {2290.9188892831990, 448, 0.0},
    {2297.0259121709414, 449, 0.0},
    {2303.1351597537055, 450, 0.0},
    {2309.2466270932082, 451, 0.0},
    {2315.3603092730405, 452, 0.0},
    {2321.4762013985237, 453, 0.0},
    {2327.5942985965653, 454, 0.0},
    {2333.7145960155158, 455, 0.0},
    {2339.8370888250302, 456, 0.0},
    {2345.9617722159251, 457, 0.0},
    {2352.0886414000388, 458, 0.0},
    {2358.2176916100993, 459, 0.0},
    {2364.3489180995825, 460, 0.0},
    {2370.4823161425788, 461, 0.0},
    {2376.6178810336610, 462, 0.0},
    {2382.7556080877475, 463, 0.0},
    {2388.8954926399733, 464, 0.0},
    {2395.0375300455607, 465, 0.0},
    {2401.1817156796865, 466, 0.0},
    {2407.3280449373551, 467, 0.0},
    {2413.4765132332727, 468, 0.0},
    {2419.6271160017195, 469, 0.0},
    {2425.7798486964234, 470, 0.0},
    {2431.9347067904396, 471, 0.0},
    {2438.0916857760253, 472, 0.0},
    {2444.2507811645173, 473, 0.0},
    {2450.4119884862121, 474, 0.0},
    {2456.5753032902467, 475, 0.0},
    {2462.7407211444784, 476, 0.0},
    {2468.9082376353667, 477, 0.0},
    {2475.0778483678582, 478, 0.0},
    {2481.2495489652692, 479, 0.0},
    {2487.4233350691711, 480, 0.0},
    {2493.5992023392769, 481, 0.0},
    {2499.7771464533271, 482, 0.0},
    {2505.9571631069803, 483, 0.0},
    {2512.1392480136965, 484, 0.0},
    {2518.3233969046337, 485, 0.0},
    {2524.5096055285348, 486, 0.0},
    {2530.6978696516176, 487, 0.0},
    {2536.8881850574708, 488, 0.0},
    {2543.0805475469456, 489, 0.0},
    {2549.2749529380499, 490, 0.0},
    {2555.4713970658445, 491, 0.0},
    {2561.6698757823369, 492, 0.0},
    {2567.8703849563790, 493, 0.0},
    {2574.0729204735676, 494, 0.0},
    {2580.2774782361362, 495, 0.0},
    {2586.4840541628614, 496, 0.0},
    {2592.6926441889577, 497, 0.0},
    {2598.9032442659823, 498, 0.0},
    {2605.1158503617335, 499, 0.0},
    {2611.3304584601556, 500, 0.0},
};

const double tolerance_0001 = 5.0000000000000028e-11;

template<typename T1, unsigned int T2>
void
test(const ln_factorial_fixture<T1>(&fixtures)[T2], T1 tolerance) {
  const T1 epsilon = std::numeric_limits<T1>::epsilon();

  T1 maximum_absolute_difference = T1(-1);
  T1 maximum_absolute_fraction = T1(-1);

  auto error = 0;

  for (auto fixture: fixtures) {
    const T1 g = aten::native::special_functions::ln_factorial<T1>(fixture.n);

    if (std::isnan(g) && !error) {
      error = 1;
    }

    if (!std::isnan(g)) {
      const T1 f = fixture.f0;

      const auto difference = g - f;

      const auto absolute_difference = std::abs(difference);

      if (absolute_difference > maximum_absolute_difference) {
        maximum_absolute_difference = absolute_difference;
      }

      const auto abs_f = std::abs(f);
      const auto abs_g = std::abs(g);

      if (abs_f > T1(10) * epsilon && abs_g > T1(10) * epsilon) {
        const auto fraction = difference / f;

        const auto absolute_fraction = std::abs(fraction);

        if (absolute_fraction > maximum_absolute_fraction) {
          maximum_absolute_fraction = absolute_fraction;
        }
      }
    }
  }

  EXPECT_TRUE(!error && maximum_absolute_fraction < tolerance);
}

TEST(LnFactorialTest, GSL) {
  test(fixture_0001, tolerance_0001);
}
