#include <gtest/gtest.h>
#include <ATen/native/special_functions/digamma.h>

template<typename T1>
struct digamma_fixture {
  T1 f0;
  T1 x;
  T1 f;
};

const digamma_fixture<double> fixture_0001[201] = {
    {-13.448065868232657, -9.9375000000000000, 0.0},
    {-3.2735500007603342, -9.8375000000000004, 0.0},
    {-0.57760403058307519, -9.7375000000000007, 0.0},
    {0.86835212228153857, -9.6374999999999993, 0.0},
    {1.9349089299722260, -9.5374999999999996, 0.0},
    {2.9216382925514308, -9.4375000000000000, 0.0},
    {4.0460078065722991, -9.3375000000000004, 0.0},
    {5.6749788244008128, -9.2375000000000007, 0.0},
    {9.0807507638571305, -9.1374999999999993, 0.0},
    {28.798870886846732, -9.0374999999999996, 0.0},
    {-13.548694799050267, -8.9375000000000000, 0.0},
    {-3.3752018431999784, -8.8375000000000004, 0.0},
    {-0.68029979438281840, -8.7375000000000007, 0.0},
    {0.76459077338400294, -8.6374999999999993, 0.0},
    {1.8300596508110203, -8.5374999999999996, 0.0},
    {2.8156780276507685, -8.4375000000000000, 0.0},
    {3.9389127597182165, -8.3375000000000004, 0.0},
    {5.5667244265659015, -8.2375000000000007, 0.0},
    {8.9713116393701249, -8.1374999999999993, 0.0},
    {28.688220817690439, -8.0374999999999996, 0.0},
    {-13.660582910938379, -7.9375000000000000, 0.0},
    {-3.4883560157600915, -7.8375000000000004, 0.0},
    {-0.79474900754446176, -7.7374999999999998, 0.0},
    {0.64881653315245447, -7.6374999999999993, 0.0},
    {1.7129293433439632, -7.5374999999999996, 0.0},
    {2.6971595091322498, -7.4375000000000000, 0.0},
    {3.8189727297332090, -7.3375000000000004, 0.0},
    {5.4453283719376957, -7.2374999999999998, 0.0},
    {8.8484237745467773, -7.1374999999999993, 0.0},
    {28.563804021422943, -7.0374999999999996, 0.0},
    {-13.786567162906882, -6.9375000000000000, 0.0},
    {-3.6159477222991665, -6.8375000000000004, 0.0},
    {-0.92398971836837129, -6.7374999999999998, 0.0},
    {0.51788363626211076, -6.6374999999999993, 0.0},
    {1.5802593599277110, -6.5374999999999996, 0.0},
    {2.5627057276196448, -6.4375000000000000, 0.0},
    {3.6826865287110624, -6.3375000000000004, 0.0},
    {5.3071591145974537, -6.2374999999999998, 0.0},
    {8.7083186957376704, -6.1374999999999993, 0.0},
    {28.421708106680494, -6.0374999999999996, 0.0},
    {-13.930711307051027, -5.9375000000000000, 0.0},
    {-3.7622000074910860, -5.8374999999999995, 0.0},
    {-1.0724127239342340, -5.7374999999999998, 0.0},
    {0.36722450255211908, -5.6375000000000002, 0.0},
    {1.4272956887996040, -5.5374999999999996, 0.0},
    {2.4073659217944021, -5.4375000000000000, 0.0},
    {3.5248956016893778, -5.3374999999999995, 0.0},
    {5.1468384733148884, -5.2374999999999998, 0.0},
    {8.5453859055136370, -5.1374999999999993, 0.0},
    {28.256076636701199, -5.0374999999999996, 0.0},
    {-14.099132359682605, -4.9375000000000000, 0.0},
    {-3.9335062173411930, -4.8374999999999995, 0.0},
    {-1.2467046629320553, -4.7374999999999998, 0.0},
    {0.18984091053439117, -4.6374999999999993, 0.0},
    {1.2467087813503941, -4.5374999999999996, 0.0},
    {2.2234578758173908, -4.4375000000000000, 0.0},
    {3.3375419717127968, -4.3374999999999995, 0.0},
    {4.9559076857253901, -4.2374999999999998, 0.0},
    {8.3507387035671652, -4.1374999999999993, 0.0},
    {28.057565470448097, -4.0374999999999996, 0.0},
    {-14.301664005252226, -3.9375000000000000, 0.0},
    {-4.1402245635944235, -3.8374999999999995, 0.0},
    {-1.4577864571273060, -3.7374999999999998, 0.0},
    {-0.025792512646201842, -3.6374999999999993, 0.0},
    {1.0263231064192646, -3.5374999999999996, 0.0},
    {1.9981057631413344, -3.4375000000000000, 0.0},
    {3.1069944212805201, -3.3374999999999995, 0.0},
    {4.7199194851354189, -3.2374999999999998, 0.0},
    {8.1090468606668633, -3.1374999999999993, 0.0},
    {27.809887451872243, -3.0374999999999996, 0.0},
    {-14.555632259220479, -2.9375000000000000, 0.0},
    {-4.4008108828126637, -2.8374999999999995, 0.0},
    {-1.7253449855553997, -2.7374999999999998, 0.0},
    {-0.30070660199328092, -2.6374999999999993, 0.0},
    {0.74363759405177332, -2.5374999999999996, 0.0},
    {1.7071966722322434, -2.4375000000000000, 0.0},
    {2.8073689531157262, -2.3374999999999995, 0.0},
    {4.4110391762551107, -2.2374999999999998, 0.0},
    {7.7903217610652691, -2.1374999999999993, 0.0},
    {27.480669344876357, -2.0374999999999996, 0.0},
    {-14.896057791135373, -1.9375000000000000, 0.0},
    {-4.7532337903016870, -1.8375000000000004, 0.0},
    {-2.0906417892083518, -1.7374999999999989, 0.0},
    {-0.67985352142456068, -1.6374999999999993, 0.0},
    {0.34954892410103433, -1.5374999999999996, 0.0},
    {1.2969402619758332, -1.4375000000000000, 0.0},
    {2.3795614664846987, -1.3375000000000004, 0.0},
    {3.9641118019534529, -1.2374999999999989, 0.0},
    {7.3224855037553276, -1.1374999999999993, 0.0},
    {26.989871798864090, -1.0374999999999996, 0.0},
    {-15.412186823393437, -0.93750000000000000, 0.0},
    {-5.2974514773765176, -0.83750000000000036, 0.0},
    {-2.6661813575536759, -0.73749999999999893, 0.0},
    {-1.2905405443253244, -0.63749999999999929, 0.0},
    {-0.30085757996400647, -0.53749999999999964, 0.0},
    {0.60128808806278977, -0.43750000000000000, 0.0},
    {1.6318979150828510, -0.33749999999999858, 0.0},
    {3.1560309938726441, -0.23749999999999893, 0.0},
    {6.4433646246344480, -0.13749999999999929, 0.0},
    {26.026016377177342, -0.037499999999999645, 0.0},
    {-16.478853490060104, 0.062500000000000000, 0.0},
    {-6.4914813281227159, 0.16250000000000142, 0.0},
    {-4.0221135609435086, 0.26250000000000107, 0.0},
    {-2.8591679953057181, 0.36250000000000071, 0.0},
    {-2.1613226962430776, 0.46250000000000036, 0.0},
    {-1.6844261976514960, 0.56250000000000000, 0.0},
    {-1.3310650478801245, 0.66250000000000142, 0.0},
    {-1.0544953219168485, 0.76250000000000107, 0.0},
    {-0.82936264809286220, 0.86250000000000071, 0.0},
    {-0.64065028948957758, 0.96250000000000036, 0.0},
    {-0.47885349006010436, 1.0625000000000000, 0.0},
    {-0.33763517427661566, 1.1625000000000014, 0.0},
    {-0.21258975141971440, 1.2625000000000011, 0.0},
    {-0.10054730565055119, 1.3625000000000007, 0.0},
    {0.00083946591908304628, 1.4625000000000004, 0.0},
    {0.093351580126281794, 1.5625000000000000, 0.0},
    {0.17836891438402327, 1.6625000000000014, 0.0},
    {0.25698008791921523, 1.7625000000000011, 0.0},
    {0.33005764176220936, 1.8625000000000007, 0.0},
    {0.39831074947146100, 1.9625000000000004, 0.0},
    {0.46232298052813092, 2.0625000000000000, 0.0},
    {0.52257987948682416, 2.1625000000000014, 0.0},
    {0.57948945650107697, 2.2625000000000011, 0.0},
    {0.63339764847788882, 2.3625000000000007, 0.0},
    {0.68460014967976668, 2.4625000000000004, 0.0},
    {0.73335158012628177, 2.5625000000000000, 0.0},
    {0.77987267378251901, 2.6625000000000014, 0.0},
    {0.82435597444403763, 2.7625000000000011, 0.0},
    {0.86697039344006155, 2.8625000000000007, 0.0},
    {0.90786488959884948, 2.9625000000000004, 0.0},
    {0.94717146537661578, 3.0625000000000000, 0.0},
    {0.98500762515156370, 3.1625000000000014, 0.0},
    {1.0214784067773199, 3.2625000000000011, 0.0},
    {1.0566780717583120, 3.3625000000000007, 0.0},
    {1.0906915202381422, 3.4625000000000004, 0.0},
    {1.1235954825653063, 3.5625000000000000, 0.0},
    {1.1554595282426128, 3.6625000000000014, 0.0},
    {1.1863469246702818, 3.7625000000000011, 0.0},
    {1.2163153716060002, 3.8625000000000007, 0.0},
    {1.2454176322148831, 3.9625000000000004, 0.0},
    {1.2737020776215138, 4.0625000000000000, 0.0},
    {1.3012131587484015, 4.1625000000000014, 0.0},
    {1.3279918167390057, 4.2625000000000011, 0.0},
    {1.3540758412750404, 4.3625000000000007, 0.0},
    {1.3795001844980699, 4.4625000000000004, 0.0},
    {1.4042972369512712, 4.5625000000000000, 0.0},
    {1.4284970709047287, 4.6625000000000014, 0.0},
    {1.4521276555672917, 4.7625000000000011, 0.0},
    {1.4752150479814048, 4.8625000000000007, 0.0},
    {1.4977835628142522, 4.9625000000000004, 0.0},
    {1.5198559237753599, 5.0625000000000000, 0.0},
    {1.5414533989886416, 5.1625000000000014, 0.0},
    {1.5625959223108530, 5.2625000000000011, 0.0},
    {1.5833022023065590, 5.3625000000000007, 0.0},
    {1.6035898203524117, 5.4625000000000004, 0.0},
    {1.6234753191430520, 5.5625000000000000, 0.0},
    {1.6429742827009752, 5.6625000000000014, 0.0},
    {1.6621014088481316, 5.7625000000000011, 0.0},
    {1.6808705749736927, 5.8625000000000007, 0.0},
    {1.6992948978268467, 5.9625000000000004, 0.0},
    {1.7173867879728908, 6.0625000000000000, 0.0},
    {1.7351579994729032, 6.1625000000000014, 0.0},
    {1.7526196752799739, 6.2624999999999993, 0.0},
    {1.7697823887867457, 6.3625000000000007, 0.0},
    {1.7866561819084761, 6.4625000000000021, 0.0},
    {1.8032506000419284, 6.5625000000000000, 0.0},
    {1.8195747242020790, 6.6625000000000014, 0.0},
    {1.8356372006051811, 6.7624999999999993, 0.0},
    {1.8514462679374453, 6.8625000000000007, 0.0},
    {1.8670097825228638, 6.9625000000000021, 0.0},
    {1.8823352415811381, 7.0625000000000000, 0.0},
    {1.8974298047467368, 7.1625000000000014, 0.0},
    {1.9123003140025288, 7.2624999999999993, 0.0},
    {1.9269533121659204, 7.3625000000000007, 0.0},
    {1.9413950600516094, 7.4625000000000021, 0.0},
    {1.9556315524228807, 7.5625000000000000, 0.0},
    {1.9696685328324728, 7.6625000000000014, 0.0},
    {1.9835115074443679, 7.7624999999999993, 0.0},
    {1.9971657579192303, 7.8625000000000007, 0.0},
    {2.0106363534384832, 7.9625000000000021, 0.0},
    {2.0239281619351206, 8.0625000000000000, 0.0},
    {2.0370458605931590, 8.1625000000000014, 0.0},
    {2.0499939456720639, 8.2624999999999993, 0.0},
    {2.0627767417075162, 8.3625000000000007, 0.0},
    {2.0753984101353615, 8.4625000000000021, 0.0},
    {2.0878629573815584, 8.5625000000000000, 0.0},
    {2.1001742424572689, 8.6625000000000014, 0.0},
    {2.1123359840949316, 8.7624999999999993, 0.0},
    {2.1243517674581809, 8.8625000000000007, 0.0},
    {2.1362250504557516, 8.9625000000000021, 0.0},
    {2.1479591696870584, 9.0625000000000000, 0.0},
    {2.1595573460449202, 9.1625000000000014, 0.0},
    {2.1710226899988423, 9.2625000000000028, 0.0},
    {2.1823582065804610, 9.3625000000000007, 0.0},
    {2.1935668000910482, 9.4625000000000021, 0.0},
    {2.2046512785494414, 9.5625000000000000, 0.0},
    {2.2156143578973841, 9.6625000000000014, 0.0},
    {2.2264586659779559, 9.7625000000000028, 0.0},
    {2.2371867463016226, 9.8625000000000007, 0.0},
    {2.2478010616133526, 9.9625000000000021, 0.0},
    {2.2583039972732655, 10.062500000000000, 0.0},
};

const double tolerance_0001 = 2.5000000000000014e-11;

const digamma_fixture<double> fixture_0002[199] = {
    {-0.57721566490153287, 1.0000000000000000, 0.0},
    {0.036489973978576520, 1.5000000000000000, 0.0},
    {0.42278433509846713, 2.0000000000000000, 0.0},
    {0.70315664064524319, 2.5000000000000000, 0.0},
    {0.92278433509846713, 3.0000000000000000, 0.0},
    {1.1031566406452431, 3.5000000000000000, 0.0},
    {1.2561176684318005, 4.0000000000000000, 0.0},
    {1.3888709263595289, 4.5000000000000000, 0.0},
    {1.5061176684318005, 5.0000000000000000, 0.0},
    {1.6110931485817512, 5.5000000000000000, 0.0},
    {1.7061176684318005, 6.0000000000000000, 0.0},
    {1.7929113303999329, 6.5000000000000000, 0.0},
    {1.8727843350984672, 7.0000000000000000, 0.0},
    {1.9467574842460869, 7.5000000000000000, 0.0},
    {2.0156414779556098, 8.0000000000000000, 0.0},
    {2.0800908175794199, 8.5000000000000000, 0.0},
    {2.1406414779556098, 9.0000000000000000, 0.0},
    {2.1977378764029494, 9.5000000000000000, 0.0},
    {2.2517525890667209, 10.000000000000000, 0.0},
    {2.3030010342976865, 10.500000000000000, 0.0},
    {2.3517525890667210, 11.000000000000000, 0.0},
    {2.3982391295357814, 11.500000000000000, 0.0},
    {2.4426616799758119, 12.000000000000000, 0.0},
    {2.4851956512749123, 12.500000000000000, 0.0},
    {2.5259950133091453, 13.000000000000000, 0.0},
    {2.5651956512749119, 13.500000000000000, 0.0},
    {2.6029180902322224, 14.000000000000000, 0.0},
    {2.6392697253489863, 14.500000000000000, 0.0},
    {2.6743466616607936, 15.000000000000000, 0.0},
    {2.7082352425903653, 15.500000000000000, 0.0},
    {2.7410133283274605, 16.000000000000000, 0.0},
    {2.7727513716226233, 16.500000000000000, 0.0},
    {2.8035133283274605, 17.000000000000000, 0.0},
    {2.8333574322286843, 17.500000000000000, 0.0},
    {2.8623368577392250, 18.000000000000000, 0.0},
    {2.8905002893715412, 18.500000000000000, 0.0},
    {2.9178924132947808, 19.000000000000000, 0.0},
    {2.9445543434255952, 19.500000000000000, 0.0},
    {2.9705239922421489, 20.000000000000000, 0.0},
    {2.9958363947076467, 20.500000000000000, 0.0},
    {3.0205239922421492, 21.000000000000000, 0.0},
    {3.0446168825125248, 21.500000000000000, 0.0},
    {3.0681430398611966, 22.000000000000000, 0.0},
    {3.0911285104195012, 22.500000000000000, 0.0},
    {3.1135975853157420, 23.000000000000000, 0.0},
    {3.1355729548639459, 23.500000000000000, 0.0},
    {3.1570758461853075, 24.000000000000000, 0.0},
    {3.1781261463533075, 24.500000000000000, 0.0},
    {3.1987425128519740, 25.000000000000000, 0.0},
    {3.2189424728839198, 25.500000000000000, 0.0},
    {3.2387425128519740, 26.000000000000000, 0.0},
    {3.2581581591584294, 26.500000000000000, 0.0},
    {3.2772040513135123, 27.000000000000000, 0.0},
    {3.2958940082150332, 27.500000000000000, 0.0},
    {3.3142410883505495, 28.000000000000000, 0.0},
    {3.3322576445786698, 28.500000000000000, 0.0},
    {3.3499553740648351, 29.000000000000000, 0.0},
    {3.3673453638769155, 29.500000000000000, 0.0},
    {3.3844381326855251, 30.000000000000000, 0.0},
    {3.4012436689616612, 30.500000000000000, 0.0},
    {3.4177714660188583, 31.000000000000000, 0.0},
    {3.4340305542075629, 31.500000000000000, 0.0},
    {3.4500295305349873, 32.000000000000000, 0.0},
    {3.4657765859535945, 32.500000000000000, 0.0},
    {3.4812795305349873, 33.000000000000000, 0.0},
    {3.4965458167228252, 33.500000000000000, 0.0},
    {3.5115825608380176, 34.000000000000000, 0.0},
    {3.5263965629914820, 34.500000000000000, 0.0},
    {3.5409943255438998, 35.000000000000000, 0.0},
    {3.5553820702378589, 35.500000000000000, 0.0},
    {3.5695657541153283, 36.000000000000000, 0.0},
    {3.5835510843223659, 36.500000000000000, 0.0},
    {3.5973435318931064, 37.000000000000000, 0.0},
    {3.6109483445963386, 37.500000000000000, 0.0},
    {3.6243705589201332, 38.000000000000000, 0.0},
    {3.6376150112630050, 38.500000000000000, 0.0},
    {3.6506863483938177, 39.000000000000000, 0.0},
    {3.6635890372370312, 39.500000000000000, 0.0},
    {3.6763273740348432, 40.000000000000000, 0.0},
    {3.6889054929332334, 40.500000000000000, 0.0},
    {3.7013273740348431, 41.000000000000000, 0.0},
    {3.7135968509579249, 41.500000000000000, 0.0},
    {3.7257176179372822, 42.000000000000000, 0.0},
    {3.7376932365000934, 42.500000000000000, 0.0},
    {3.7495271417468059, 43.000000000000000, 0.0},
    {3.7612226482647997, 43.500000000000000, 0.0},
    {3.7727829557002943, 44.000000000000000, 0.0},
    {3.7842111540119259, 44.500000000000000, 0.0},
    {3.7955102284275672, 45.000000000000000, 0.0},
    {3.8066830641242855, 45.500000000000000, 0.0},
    {3.8177324506497894, 46.000000000000000, 0.0},
    {3.8286610861023074, 46.500000000000000, 0.0},
    {3.8394715810845721, 47.000000000000000, 0.0},
    {3.8501664624463934, 47.500000000000000, 0.0},
    {3.8607481768292526, 48.000000000000000, 0.0},
    {3.8712190940253408, 48.500000000000000, 0.0},
    {3.8815815101625861, 49.000000000000000, 0.0},
    {3.8918376507263717, 49.500000000000000, 0.0},
    {3.9019896734278920, 50.000000000000000, 0.0},
    {3.9120396709283920, 50.500000000000000, 0.0},
    {3.9219896734278921, 51.000000000000000, 0.0},
    {3.9318416511264118, 51.500000000000000, 0.0},
    {3.9415975165651469, 52.000000000000000, 0.0},
    {3.9512591268545671, 52.500000000000000, 0.0},
    {3.9608282857959165, 53.000000000000000, 0.0},
    {3.9703067459021861, 53.500000000000000, 0.0},
    {3.9796962103242182, 54.000000000000000, 0.0},
    {3.9889983346872331, 54.500000000000000, 0.0},
    {3.9982147288427368, 55.000000000000000, 0.0},
    {4.0073469585404435, 55.500000000000000, 0.0},
    {4.0163965470245548, 56.000000000000000, 0.0},
    {4.0253649765584623, 56.500000000000000, 0.0},
    {4.0342536898816981, 57.000000000000000, 0.0},
    {4.0430640916027096, 57.500000000000000, 0.0},
    {4.0517975495308205, 58.000000000000000, 0.0},
    {4.0604553959505356, 58.500000000000000, 0.0},
    {4.0690389288411657, 59.000000000000000, 0.0},
    {4.0775494130445527, 59.500000000000000, 0.0},
    {4.0859880813835385, 60.000000000000000, 0.0},
    {4.0943561357336282, 60.500000000000000, 0.0},
    {4.1026547480502051, 61.000000000000000, 0.0},
    {4.1108850613534633, 61.500000000000000, 0.0},
    {4.1190481906731558, 62.000000000000000, 0.0},
    {4.1271452239550896, 62.500000000000000, 0.0},
    {4.1351772229312207, 63.000000000000000, 0.0},
    {4.1431452239550897, 63.500000000000000, 0.0},
    {4.1510502388042365, 64.000000000000000, 0.0},
    {4.1588932554511526, 64.500000000000000, 0.0},
    {4.1666752388042365, 65.000000000000000, 0.0},
    {4.1743971314201449, 65.500000000000000, 0.0},
    {4.1820598541888518, 66.000000000000000, 0.0},
    {4.1896643069926638, 66.500000000000000, 0.0},
    {4.1972113693403665, 67.000000000000000, 0.0},
    {4.2047019009776259, 67.500000000000000, 0.0},
    {4.2121367424746952, 68.000000000000000, 0.0},
    {4.2195167157924409, 68.500000000000000, 0.0},
    {4.2268426248276363, 69.000000000000000, 0.0},
    {4.2341152559384261, 69.500000000000000, 0.0},
    {4.2413353784508248, 70.000000000000000, 0.0},
    {4.2485037451470591, 70.500000000000000, 0.0},
    {4.2556210927365390, 71.000000000000000, 0.0},
    {4.2626881423101795, 71.500000000000000, 0.0},
    {4.2697055997787920, 72.000000000000000, 0.0},
    {4.2766741562961936, 72.500000000000000, 0.0},
    {4.2835944886676813, 73.000000000000000, 0.0},
    {4.2904672597444700, 73.500000000000000, 0.0},
    {4.2972931188046672, 74.000000000000000, 0.0},
    {4.3040727019213403, 74.500000000000000, 0.0},
    {4.3108066323181813, 75.000000000000000, 0.0},
    {4.3174955207132868, 75.500000000000000, 0.0},
    {4.3241399656515149, 76.000000000000000, 0.0},
    {4.3307405538258692, 76.500000000000000, 0.0},
    {4.3372978603883565, 77.000000000000000, 0.0},
    {4.3438124492507058, 77.500000000000000, 0.0},
    {4.3502848733753696, 78.000000000000000, 0.0},
    {4.3567156750571581, 78.500000000000000, 0.0},
    {4.3631053861958824, 79.000000000000000, 0.0},
    {4.3694545285603423, 79.500000000000000, 0.0},
    {4.3757636140439837, 80.000000000000000, 0.0},
    {4.3820331449125440, 80.500000000000000, 0.0},
    {4.3882636140439839, 81.000000000000000, 0.0},
    {4.3944555051609910, 81.500000000000000, 0.0},
    {4.4006092930563296, 82.000000000000000, 0.0},
    {4.4067254438112977, 82.500000000000000, 0.0},
    {4.4128044150075487, 83.000000000000000, 0.0},
    {4.4188466559325095, 83.500000000000000, 0.0},
    {4.4248526077786332, 84.000000000000000, 0.0},
    {4.4308227038367018, 84.500000000000000, 0.0},
    {4.4367573696833951, 85.000000000000000, 0.0},
    {4.4426570233633287, 85.500000000000000, 0.0},
    {4.4485220755657480, 86.000000000000000, 0.0},
    {4.4543529297960776, 86.500000000000000, 0.0},
    {4.4601499825424922, 87.000000000000000, 0.0},
    {4.4659136234376957, 87.500000000000000, 0.0},
    {4.4716442354160550, 88.000000000000000, 0.0},
    {4.4773421948662673, 88.500000000000000, 0.0},
    {4.4830078717796917, 89.000000000000000, 0.0},
    {4.4886416298945155, 89.500000000000000, 0.0},
    {4.4942438268358718, 90.000000000000000, 0.0},
    {4.4998148142520575, 90.500000000000000, 0.0},
    {4.5053549379469828, 91.000000000000000, 0.0},
    {4.5108645380089634, 91.500000000000000, 0.0},
    {4.5163439489359938, 92.000000000000000, 0.0},
    {4.5217934997575977, 92.500000000000000, 0.0},
    {4.5272135141533854, 93.000000000000000, 0.0},
    {4.5326043105684084, 93.500000000000000, 0.0},
    {4.5379662023254284, 94.000000000000000, 0.0},
    {4.5432994977341838, 94.500000000000000, 0.0},
    {4.5486045001977686, 95.000000000000000, 0.0},
    {4.5538815083161941, 95.500000000000000, 0.0},
    {4.5591308159872419, 96.000000000000000, 0.0},
    {4.5643527125046761, 96.500000000000000, 0.0},
    {4.5695474826539089, 97.000000000000000, 0.0},
    {4.5747154068051943, 97.500000000000000, 0.0},
    {4.5798567610044243, 98.000000000000000, 0.0},
    {4.5849718170616045, 98.500000000000000, 0.0},
    {4.5900608426370777, 99.000000000000000, 0.0},
    {4.5951241013255641, 99.500000000000000, 0.0},
    {4.6001618527380872, 100.00000000000000, 0.0},
};

const double tolerance_0002 = 2.5000000000000020e-13;

template<typename T1, unsigned int T2>
void
test(const digamma_fixture<T1>(&fixtures)[T2], T1 tolerance) {
  const T1 epsilon = std::numeric_limits<T1>::epsilon();

  T1 maximum_absolute_difference = T1(-1);
  T1 maximum_absolute_fraction = T1(-1);

  auto error = 0;

  for (auto fixture: fixtures) {
    const T1 g = aten::native::special_functions::digamma(fixture.x);

    if (std::isnan(g) && !error) {
      error = 1;
    }

    if (!std::isnan(g)) {
      const T1 f = fixture.f0;

      const auto difference = g - f;

      const auto absolute_difference = std::abs(difference);

      if (absolute_difference > maximum_absolute_difference) {
        maximum_absolute_difference = absolute_difference;
      }

      const auto abs_f = std::abs(f);
      const auto abs_g = std::abs(g);

      if (abs_f > T1(10) * epsilon && abs_g > T1(10) * epsilon) {
        const auto fraction = difference / f;

        const auto absolute_fraction = std::abs(fraction);

        if (absolute_fraction > maximum_absolute_fraction) {
          maximum_absolute_fraction = absolute_fraction;
        }
      }
    }
  }

  EXPECT_TRUE(!error && maximum_absolute_fraction < tolerance);
}

TEST(DigammaTest, GSL) {
  test(fixture_0001, tolerance_0001);
  test(fixture_0002, tolerance_0002);
}
